{"version":3,"file":"NewProject.js","sourceRoot":"","sources":["../../src/menu/NewProject.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,IAAI,EAA8B,MAAM,aAAa,CAAC;AAC/D,OAAO,EAAE,GAAG,EAAE,MAAM,mBAAmB,CAAC;AAExC,OAAO,oBAAoB,CAAC;AAC5B,OAAO,wCAAwC,CAAC;AAGhD,OAAO,2CAA2C,CAAC;AACnD,OAAO,EACL,cAAc,GAGf,MAAM,qCAAqC,CAAC;AAC7C,OAAO,EAAE,eAAe,EAAE,MAAM,mDAAmD,CAAC;AAEpF,OAAO,EAAE,WAAW,EAAE,MAAM,gDAAgD,CAAC;AAC7E,OAAO,EACL,WAAW,GAEZ,MAAM,kCAAkC,CAAC;AAC1C,OAAO,EAAE,iBAAiB,EAAE,MAAM,yBAAyB,CAAC;AAE5D,MAAM,CAAC,OAAO,OAAO,gBAAiB,SAAQ,iBAAiB;IAErD,gBAAgB,CACtB,MAA4B,EAC5B,MAAe;QAGf,IAAI,OAAO,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,IAAI,EAAE,CAAA;QAEnC,MAAM,qBAAqB,GAAG,CAAC,MAAM,EAAE,MAAM,EAAC,MAAM,CAAC,CAAC;QACtD,MAAM,iBAAiB,GAAG,qBAAqB,CAAC,IAAI,CAAC,CAAC,SAAS,EAAE,EAAE;YACjE,OAAO,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE,QAAQ,CAAC,SAAS,CAAC,CAAC;QAC9C,CAAC,CAAC,CAAA;QAEF,IAAG,CAAC,iBAAiB,EAAE;YACrB,OAAO,GAAG,OAAO,GAAG,MAAM,CAAC;SAC5B;QAED,MAAM,OAAO,GAAqB,CACjB,MAAM,CAAC,UAAW,CAAC,aAAa,CAAC,UAAU,CAAE,CAAC,QAAS;aACnE,KAAK,CACT,CAAC;QAEF,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC,CAAC;QACnD,IAAI,CAAC,aAAa,CAChB,eAAe,CAAC,WAAW,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,EAAE,OAAO,CAAC,CACrE,CAAC;QAEF,OAAO,CAAC,EAAE,OAAO,EAAE,EAAE,EAAE,KAAK,EAAE,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC;IACrD,CAAC;IACO,gBAAgB;QACtB,OAAO;YACL;gBACE,KAAK,EAAE,GAAG,CAAC,UAAU,CAAC;gBACtB,OAAO,EAAE;oBACP,IAAI,EAAE,mBAAmB;oBACzB,KAAK,EAAE,GAAG,CAAC,QAAQ,CAAC;oBACpB,MAAM,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE,EAAE,CAAC,IAAI,CAAC,gBAAgB,CAAC,MAAM,EAAE,MAAM,CAAC;iBAClE;gBACD,OAAO,EAAE;oBACP,IAAI,CAAA;;;;;;;;;;;;;;;;;wBAiBU;iBACf;aACF;SACF,CAAC;IACJ,CAAC;IAED,KAAK,CAAC,GAAG;QACP,IAAI,CAAC,aAAa,CAAC,cAAc,CAAC,IAAI,CAAC,gBAAgB,EAAE,CAAC,CAAC,CAAC;IAC9D,CAAC;IAED,MAAM;QACJ,OAAO,IAAI,CAAA,GAAG,IAAI,CAAC,kBAAkB,EAAE,EAAE,CAAC;IAC5C,CAAC;CACF","sourcesContent":["import { html, LitElement, TemplateResult } from 'lit-element';\nimport { get } from '../translation.js';\n\nimport '@material/mwc-list';\nimport '@material/mwc-list/mwc-radio-list-item';\nimport { ListItemBase } from '@material/mwc-list/mwc-list-item-base';\n\nimport '@openscd/open-scd/src/wizard-textfield.js';\nimport {\n  newWizardEvent,\n  Wizard,\n  WizardInputElement,\n} from '@openscd/open-scd/src/foundation.js';\nimport { newOpenDocEvent } from '@openscd/core/foundation/deprecated/open-event.js';\nimport { EditorAction } from '@openscd/core/foundation/deprecated/editor.js';\nimport { newLogEvent } from '@openscd/core/foundation/deprecated/history.js';\nimport {\n  newEmptySCD,\n  SupportedVersion,\n} from '@openscd/open-scd/src/schemas.js';\nimport { DirectDialogMixin } from '../directDialogMixin.js';\n\nexport default class NewProjectPlugin extends DirectDialogMixin {\n\n  private createNewProject(\n    inputs: WizardInputElement[],\n    wizard: Element\n  ): EditorAction[] {\n\n    let docName = inputs[0].value ?? ''\n\n    const acceptedFileExtension = ['.ssd', '.scd','.fsd'];\n    const isValidFileFormat = acceptedFileExtension.some((extension) => {\n      return inputs[0].value?.endsWith(extension);\n    })\n\n    if(!isValidFileFormat) {\n      docName = docName + '.scd';\n    }\n\n    const version = <SupportedVersion>(\n      (<ListItemBase>wizard.shadowRoot!.querySelector('mwc-list')!.selected)\n        .value\n    );\n\n    this.dispatchEvent(newLogEvent({ kind: 'reset' }));\n    this.dispatchEvent(\n      newOpenDocEvent(newEmptySCD(docName.slice(0, -4), version), docName)\n    );\n\n    return [{ actions: [], title: '', derived: true }];\n  }\n  private newProjectWizard(): Wizard {\n    return [\n      {\n        title: get('menu.new'),\n        primary: {\n          icon: 'create_new_folder',\n          label: get('create'),\n          action: (inputs, wizard) => this.createNewProject(inputs, wizard),\n        },\n        content: [\n          html`<wizard-textfield\n              id=\"srcName\"\n              label=\"name\"\n              value=\"project.scd\"\n              required\n              dialogInitialFocus\n            ></wizard-textfield>\n            <mwc-list activatable>\n              <mwc-radio-list-item left value=\"2003\"\n                >Edition 1 (Schema 1.7)</mwc-radio-list-item\n              >\n              <mwc-radio-list-item left value=\"2007B\"\n                >Edition 2 (Schema 3.1)</mwc-radio-list-item\n              >\n              <mwc-radio-list-item left selected value=\"2007B4\"\n                >Edition 2.1 (2007B4)</mwc-radio-list-item\n              >\n            </mwc-list>`,\n        ],\n      },\n    ];\n  }\n\n  async run(): Promise<void> {\n    this.dispatchEvent(newWizardEvent(this.newProjectWizard()));\n  }\n\n  render(): TemplateResult {\n    return html`${this.renderWizardDialog()}`;\n  }\n}\n"]}